lsDOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Markdown Editor</title>

	<!-- New base CSS with CSS variables - no Zen Garden dependencies -->
	<link rel="stylesheet" media="screen" href="css/markdown-editor-base.css">
	<!-- Tab Menu Layout (can be swapped for other layouts) -->
	<link rel="stylesheet" media="screen" href="css/tab-menus/tab-menu-steel.css" id="tab-menu-stylesheet">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Markdown document editor with live preview and theming.">
	<meta name="robots" content="all">

	<!-- Typekit fonts for themes -->
	<script src="https://use.typekit.net/fzq7emy.js"></script>
	<script>try{Typekit.load();}catch(e){}</script>
</head>

<body>
<div class="page-wrapper">

	<section class="intro tab-menu-steel" id="zen-intro">
		<header role="banner">
			<h1>Markdown Editor</h1>
			<h2>Create Your Document</h2>
		</header>

		<!-- File Tab -->
		<div class="editor-panel files-panel" id="files-panel" role="article">
			<div class="panel-tab-label">File</div>
			<div class="panel-content">
				<h3>File</h3>
				<button id="new-file-btn" class="panel-button">New File</button>
				<button id="open-file-btn" class="panel-button">Open File</button>
				<button id="open-folder-btn" class="panel-button">Open Folder</button>
				<button id="save-file-btn" class="panel-button">Save</button>
				<button id="save-as-btn" class="panel-button">Save As...</button>
				<button id="close-file-btn" class="panel-button">Close File</button>
				<button id="close-folder-btn" class="panel-button">Close Folder</button>
				<button id="exit-btn" class="panel-button">Exit</button>
				<input type="file" id="file-input" accept=".md,.markdown,.txt" style="display: none;">
			</div>
		</div>

		<!-- Edit Tab -->
		<div class="editor-panel edit-panel" id="edit-panel" role="article">
			<div class="panel-tab-label">Edit</div>
			<div class="panel-content">
				<h3>Edit</h3>
				<button id="undo-btn" class="panel-button">Undo</button>
				<button id="redo-btn" class="panel-button">Redo</button>
				<button id="cut-btn" class="panel-button">Cut</button>
				<button id="copy-btn" class="panel-button">Copy</button>
				<button id="paste-btn" class="panel-button">Paste</button>
				<button id="select-all-btn" class="panel-button">Select All</button>
				<button id="find-btn" class="panel-button">Find & Replace</button>
			</div>
		</div>

		<!-- View Tab -->
		<div class="editor-panel view-panel" id="view-panel" role="article">
			<div class="panel-tab-label">View</div>
			<div class="panel-content">
				<div class="panel-header-row">
					<h3>View Options</h3>
					<label class="expand-all-toggle">
						<input type="checkbox" id="view-expand-all-sections">
						<span>Expand/Collapse All</span>
					</label>
				</div>

				<div class="view-two-col">
					<!-- Left Column -->
					<div class="view-col-left">
						<!-- Tab Menu Section -->
						<div class="view-section">
							<button class="view-section-header">
								<span class="view-toggle">â–¶</span>
								<span>Tab Menu</span>
							</button>
							<div class="view-section-content">
								<button id="tab-menu-selector-btn" class="panel-button">Select Tab Menu Style...</button>
								<div id="current-tab-menu-display" class="current-display">Current: Steel</div>
							</div>
						</div>

						<!-- Theme Section -->
						<div class="view-section">
							<button class="view-section-header">
								<span class="view-toggle">â–¶</span>
								<span>Theme</span>
							</button>
							<div class="view-section-content">
								<button id="theme-selector-btn" class="panel-button">Select Theme...</button>
								<button id="theme-load-custom-btn" class="panel-button">Load Custom CSS</button>
								<div id="current-theme-display" class="current-display">Current: Default</div>
								<input type="file" id="custom-theme-input" accept=".css" style="display: none;">
							</div>
						</div>

					</div>

					</div>
			</div>
		</div>

		<!-- Settings Tab -->
		<div class="editor-panel settings-panel" id="settings-panel" role="article">
			<div class="panel-tab-label">Settings</div>
			<div class="panel-content">
				<div class="panel-header-row">
					<h3>Settings</h3>
					<label class="expand-all-toggle">
						<input type="checkbox" id="settings-expand-all-sections">
						<span>Expand/Collapse All</span>
					</label>
				</div>

				<div class="settings-two-col">
					<!-- Left Column -->
					<div class="settings-col-left">
						<!-- Editor Settings Section -->
						<div class="settings-section">
							<button class="settings-section-header">
								<span class="settings-toggle">â–¶</span>
								<span>Editor</span>
							</button>
							<div class="settings-section-content">
								<!-- Font Size -->
								<div class="settings-row">
									<label for="settings-font-size">Font Size</label>
									<div class="settings-control">
										<input type="range" id="settings-font-size" min="8" max="72" value="14">
										<span class="settings-value" id="settings-font-size-value">14px</span>
									</div>
								</div>

								<!-- Line Height -->
								<div class="settings-row">
									<label for="settings-line-height">Line Height</label>
									<div class="settings-control">
										<input type="range" id="settings-line-height" min="1.0" max="3.0" step="0.1" value="1.5">
										<span class="settings-value" id="settings-line-height-value">1.5</span>
									</div>
								</div>

								<!-- Tab Size -->
								<div class="settings-row">
									<label for="settings-tab-size">Tab Size</label>
									<div class="settings-control">
										<select id="settings-tab-size">
											<option value="1">1 space</option>
											<option value="2" selected>2 spaces</option>
											<option value="4">4 spaces</option>
											<option value="8">8 spaces</option>
										</select>
									</div>
								</div>

								<!-- Font Family -->
								<div class="settings-row">
									<label for="settings-font-family">Font Family</label>
									<div class="settings-control">
										<select id="settings-font-family">
											<option value="'Consolas', monospace">Consolas</option>
											<option value="'Monaco', monospace">Monaco</option>
											<option value="'Courier New', monospace">Courier New</option>
											<option value="'Fira Code', monospace">Fira Code</option>
											<option value="'Source Code Pro', monospace">Source Code Pro</option>
											<option value="monospace">System Monospace</option>
										</select>
									</div>
								</div>
							</div>
						</div>

					</div>

					<!-- Right Column -->
					<div class="settings-col-right">
						<!-- Editor Options Section -->
						<div class="settings-section">
							<button class="settings-section-header">
								<span class="settings-toggle">â–¶</span>
								<span>Options</span>
							</button>
							<div class="settings-section-content">
								<!-- Line Numbers -->
								<div class="settings-row">
									<label for="settings-line-numbers">Line Numbers</label>
									<div class="settings-control">
										<label class="settings-checkbox">
											<input type="checkbox" id="settings-line-numbers">
											<span>Show in editor</span>
										</label>
									</div>
								</div>

								<!-- Word Wrap -->
								<div class="settings-row">
									<label for="settings-word-wrap">Word Wrap</label>
									<div class="settings-control">
										<label class="settings-checkbox">
											<input type="checkbox" id="settings-word-wrap" checked>
											<span>Wrap long lines</span>
										</label>
									</div>
								</div>
							</div>
						</div>

						<!-- Backup & Restore Section -->
						<div class="settings-section">
							<button class="settings-section-header">
								<span class="settings-toggle">â–¶</span>
								<span>Backup & Restore</span>
							</button>
							<div class="settings-section-content">
								<button id="settings-export-btn" class="panel-button">Export Settings</button>
								<button id="settings-import-btn" class="panel-button">Import Settings</button>
								<input type="file" id="settings-import-input" accept=".json" style="display: none;">
							</div>
						</div>

						<!-- Reset Section -->
						<div class="settings-section">
							<button class="settings-section-header">
								<span class="settings-toggle">â–¶</span>
								<span>Reset</span>
							</button>
							<div class="settings-section-content">
								<button id="settings-reset-editor-btn" class="panel-button settings-danger">Reset Editor</button>
								<button id="settings-reset-all-btn" class="panel-button settings-danger">Reset All</button>
								<p class="settings-hint settings-warning">Cannot be undone</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Help Panel -->
		<div class="editor-panel help-panel" id="help-panel" role="article">
			<div class="panel-tab-label">Help</div>
			<div class="panel-content help-content">
				<div class="help-header-row">
					<h3>Help & Documentation</h3>
					<label class="expand-all-toggle">
						<input type="checkbox" id="expand-all-sections">
						<span>Expand/Collapse All</span>
					</label>
				</div>

				<!-- Markdown Basics Section -->
				<div class="help-section">
					<button class="help-section-header">
						<span class="help-toggle">â–¶</span>
						<span>Markdown Basics</span>
					</button>
					<div class="help-section-content">
						<div class="help-row-header">
							<span class="help-col-label">Syntax</span>
							<span class="help-col-label">Preview</span>
						</div>

						<h4>Headers</h4>
						<div class="help-two-col">
							<code># H1 Header<br>## H2 Header<br>### H3 Header</code>
							<div class="help-preview markdown-output">
								<h1>H1 Header</h1>
								<h2>H2 Header</h2>
								<h3>H3 Header</h3>
							</div>
						</div>

						<h4>Text Formatting</h4>
						<div class="help-two-col">
							<code>**bold** or __bold__<br>*italic* or _italic_<br>~~strikethrough~~</code>
							<div class="help-preview markdown-output">
								<strong>bold</strong> or <strong>bold</strong><br>
								<em>italic</em> or <em>italic</em><br>
								<del>strikethrough</del>
							</div>
						</div>

						<h4>Links & Images</h4>
						<div class="help-two-col">
							<code>[Link text](url)<br>![Image alt](image-url)</code>
							<div class="help-preview markdown-output">
								<a href="#">Link text</a><br>
								<img src="assets/sample-photo.jpg" alt="Sample">
							</div>
						</div>

						<h4>Lists</h4>
						<div class="help-two-col">
							<code>- Unordered item<br>1. Ordered item<br>- [ ] Task item</code>
							<div class="help-preview markdown-output">
								<ul><li>Unordered item</li></ul>
								<ol><li>Ordered item</li></ol>
								<code>[ ]</code> Task item
							</div>
						</div>

						<h4>Code</h4>
						<div class="help-two-col">
							<code>`inline code`<br>```language<br>code block<br>```</code>
							<div class="help-preview markdown-output">
								<code>inline code</code><br>
								<pre>code block</pre>
							</div>
						</div>
					</div>
				</div>

				<!-- Shortcut Syntax Section -->
				<div class="help-section">
					<button class="help-section-header">
						<span class="help-toggle">â–¶</span>
						<span>Shortcut Syntax</span>
					</button>
					<div class="help-section-content">
						<div class="help-row-header">
							<span class="help-col-label">Syntax</span>
							<span class="help-col-label">Preview</span>
						</div>

						<h4>Headers</h4>
						<div class="help-two-col">
							<code>h1: Header Text<br>heading1: Header Text<br>&lt;h1&gt;Header Text&lt;/h1&gt;<br>title: Main Title</code>
							<div class="help-preview markdown-output">
								<h1>Header Text</h1>
								<h1>Header Text</h1>
								<h1>Header Text</h1>
								<h1>Main Title</h1>
							</div>
						</div>

						<h4>Text Formatting</h4>
						<div class="help-two-col">
							<code>&lt;b&gt;bold&lt;/b&gt;<br>[b]bold[/b]<br>:b:bold:b:<br>b{bold}</code>
							<div class="help-preview markdown-output">
								<strong>bold</strong><br>
								<strong>bold</strong><br>
								<strong>bold</strong><br>
								<strong>bold</strong>
							</div>
						</div>

						<h4>Links</h4>
						<div class="help-two-col">
							<code>link: text | url<br>&lt;link href="url"&gt;text&lt;/link&gt;<br>[url=url]text[/url]</code>
							<div class="help-preview markdown-output">
								<a href="#">text</a><br>
								<a href="#">text</a><br>
								<a href="#">text</a>
							</div>
						</div>

						<h4>Images</h4>
						<div class="help-two-col">
							<code>img: alt | url<br>&lt;img src="url" alt="alt" /&gt;<br>[img=url]alt[/img]</code>
							<div class="help-preview markdown-output">
								<img src="assets/sample-photo.jpg" alt="Sample">
							</div>
						</div>

						<h4>Lists</h4>
						<div class="help-two-col">
							<code>ul: List item<br>ol: Numbered item<br>task: Task item<br>done: Completed task</code>
							<div class="help-preview markdown-output">
								<ul><li>List item</li></ul>
								<ol><li>Numbered item</li></ol>
								<code>[ ]</code> Task item<br>
								<code>[x]</code> Completed task
							</div>
						</div>

						<h4>Blockquotes</h4>
						<div class="help-two-col">
							<code>quote: Quote text<br>bq: Quote text<br>&lt;blockquote&gt;text&lt;/blockquote&gt;</code>
							<div class="help-preview markdown-output">
								<blockquote>Quote text</blockquote>
							</div>
						</div>

						<h4>Horizontal Rules</h4>
						<div class="help-two-col">
							<code>hr:<br>divider:<br>&lt;hr&gt;</code>
							<div class="help-preview markdown-output">
								<hr>
							</div>
						</div>
					</div>
				</div>

				<!-- Keyboard Shortcuts Section -->
				<div class="help-section">
					<button class="help-section-header">
						<span class="help-toggle">â–¶</span>
						<span>Keyboard Shortcuts</span>
					</button>
					<div class="help-section-content">
						<h4>File Operations</h4>
						<code>Ctrl+S - Save<br>Ctrl+Shift+S - Save As<br>Ctrl+N - New File<br>Ctrl+O - Open File</code>

						<h4>Editing</h4>
						<code>Ctrl+Z - Undo<br>Ctrl+Y - Redo<br>Ctrl+X - Cut<br>Ctrl+C - Copy<br>Ctrl+V - Paste<br>Ctrl+A - Select All</code>

						<h4>Find & Replace</h4>
						<code>Ctrl+F - Find<br>Ctrl+H - Replace</code>
					</div>
				</div>

				<!-- Theme Guide Section -->
				<div class="help-section">
					<button class="help-section-header">
						<span class="help-toggle">â–¶</span>
						<span>Theme Guide</span>
					</button>
					<div class="help-section-content">
						<h4>Available Themes</h4>
						<p><strong>Default:</strong> Clean, professional light theme</p>
						<p><strong>Cyberpunk:</strong> Neon-styled dark theme with matrix effects</p>
						<p><strong>LCARS:</strong> Star Trek inspired interface</p>

						<h4>How to Switch Themes</h4>
						<p>1. Click the <strong>Settings</strong> tab<br>
						2. Select your preferred theme from the dropdown<br>
						3. Theme applies instantly</p>

						<h4>Protected Themes</h4>
						<p>Built-in themes (Default, Cyberpunk, LCARS) cannot be deleted to preserve core functionality.</p>
					</div>
				</div>

				<!-- Tips & Tricks Section -->
				<div class="help-section">
					<button class="help-section-header">
						<span class="help-toggle">â–¶</span>
						<span>Tips & Tricks</span>
					</button>
					<div class="help-section-content">
						<h4>Auto-Save</h4>
						<p>Your work is automatically saved every second to prevent data loss.</p>

						<h4>Mix Syntax Styles</h4>
						<p>You can use standard markdown and shortcuts together in the same document!</p>

						<h4>Multiple Shortcuts</h4>
						<p>Most features support 5-7 different syntax options. Use whichever feels most natural!</p>

						<h4>Live Preview</h4>
						<p>Changes appear instantly in the preview pane as you type.</p>

						<h4>Image Paths</h4>
						<p>Use relative paths for local images (e.g., image.jpg) or full URLs for web images.</p>
					</div>
				</div>

				<!-- Regex Help Section -->
				<div class="help-section">
					<button class="help-section-header">
						<span class="help-toggle">â–¶</span>
						<span>Regular Expressions</span>
					</button>
					<div class="help-section-content">
						<h4>Regex Documentation</h4>
						<p>The Find & Replace dialog supports powerful regular expression patterns for advanced searching.</p>

						<button class="panel-button" id="view-regex-docs-btn" style="width: 100%; margin-top: 10px;">
							ðŸ“– View Regex Documentation
						</button>

						<p style="margin-top: 15px; font-size: 0.9em; color: var(--preview-text, #ccc);">
							<strong>Quick Tips:</strong><br>
							â€¢ Use <code>\d</code> to match digits<br>
							â€¢ Use <code>\w</code> to match word characters<br>
							â€¢ Use <code>.*</code> to match any characters<br>
							â€¢ Click the <strong>?</strong> button in Find & Replace for full documentation
						</p>
					</div>
				</div>

				<!-- About Section -->
				<div class="help-section">
					<button class="help-section-header">
						<span class="help-toggle">â–¶</span>
						<span>About</span>
					</button>
					<div class="help-section-content">
						<h4>Markdown Editor</h4>
						<p><strong>Version:</strong> 1.0.0</p>
						<p><strong>Features:</strong></p>
						<ul>
							<li>Full GitHub Flavored Markdown support</li>
							<li>Multiple shortcut syntax options</li>
							<li>Live preview rendering</li>
							<li>Auto-save functionality</li>
							<li>Multiple theme support</li>
							<li>Document management</li>
						</ul>

						<h4>Supported Markdown</h4>
						<p>Headers (H1-H6), Bold, Italic, Strikethrough, Links, Images, Code (inline & block), Lists (ordered, unordered, tasks), Blockquotes, Horizontal Rules, Tables</p>
					</div>
				</div>
			</div>
		</div>

		<!-- Back Button -->
		<div class="editor-panel back-panel" id="back-panel" role="article">
			<div class="panel-tab-label">Back</div>
			<div class="panel-content">
				<h3>Go Back</h3>
				<button id="back-to-home" class="panel-button">
					Return to Main Page
				</button>
			</div>
		</div>
	</section>

	<!-- Document Tabs Bar -->
	<div class="document-tabs-container">
		<div class="document-tabs" id="document-tabs">
			<!-- Tabs will be added dynamically by TabController -->
		</div>
		<button class="document-tab-new" id="new-document-btn" title="New Document">+</button>
	</div>

	<div class="main supporting" id="zen-supporting" role="main">
		<!-- WYSIWYG Unified Editor -->
		<div class="editor-container" data-layout="wysiwyg">
			<!-- Single unified contenteditable pane -->
			<section class="editor-section unified-editor">
				<div class="editor-section-content">
					<!-- Typora wrapper for unified editing -->
					<div id="write" class="typora-write">
						<!-- WYSIWYG contenteditable area -->
						<div
							id="wysiwyg-editor"
							class="wysiwyg-content"
							contenteditable="true"
							spellcheck="true"
							aria-label="WYSIWYG markdown editor"
						></div>
						<!-- Source mode container with line numbers -->
						<div id="source-editor-container" class="source-editor-container" style="display: none;">
							<div id="line-numbers" class="line-numbers-gutter"></div>
							<textarea
								id="source-editor"
								class="source-textarea"
								placeholder="Raw markdown source..."
								aria-label="Markdown source editor"
							></textarea>
						</div>
					</div>
				</div>
			</section>

			<!-- Center gap with toolbar (same structure as split view) -->
			<div class="editor-gap" id="editor-gap">
				<!-- Resize handle at top of gap (disabled in WYSIWYG mode) -->
				<div class="editor-divider" id="editor-divider" title="Toolbar">
					<span class="divider-grip">&#x2261;</span>
				</div>
				<!-- Toolbar area for buttons -->
				<div class="gap-toolbar" id="gap-toolbar">
					<button class="divider-sync-btn" id="toolbar-source-toggle" title="Toggle Source Mode (Ctrl+/)">
						<span class="sync-icon">&#x1F4DD;</span>
					</button>
					<button class="divider-sync-btn" id="toolbar-bold" title="Bold (Ctrl+B)">
						<span class="sync-icon"><strong>B</strong></span>
					</button>
					<button class="divider-sync-btn" id="toolbar-italic" title="Italic (Ctrl+I)">
						<span class="sync-icon"><em>I</em></span>
					</button>
					<button class="divider-sync-btn" id="toolbar-heading" title="Heading">
						<span class="sync-icon">H</span>
					</button>
					<button class="divider-sync-btn" id="toolbar-link" title="Link (Ctrl+K)">
						<span class="sync-icon">&#x1F517;</span>
					</button>
					<button class="divider-sync-btn" id="toolbar-image" title="Image">
						<span class="sync-icon">&#x1F5BC;</span>
					</button>
					<button class="divider-sync-btn" id="toolbar-code" title="Code">
						<span class="sync-icon">&lt;/&gt;</span>
					</button>
				</div>
			</div>
		</div>

		<!-- Find/Replace Dialog -->
		<div class="find-replace-dialog" id="find-replace-dialog" style="display: none;">
			<div class="find-replace-header">
				<span class="find-replace-title">Find & Replace</span>
				<button class="find-close-btn" id="find-close-btn" title="Close (Esc)" aria-label="Close find dialog">&times;</button>
			</div>
			<div class="find-replace-body">
				<!-- Find input row -->
				<div class="find-input-row">
					<input type="text" id="find-input" class="find-input" placeholder="Find" aria-label="Find text">
					<span class="find-match-counter" id="find-match-counter"></span>
				</div>
				<!-- Replace input row -->
				<div class="replace-input-row">
					<input type="text" id="replace-input" class="replace-input" placeholder="Replace" aria-label="Replace text">
				</div>
				<!-- Options row -->
				<div class="find-options-row">
					<label class="find-option">
						<input type="checkbox" id="find-case-sensitive">
						<span>Case sensitive (Aa)</span>
					</label>
					<label class="find-option">
						<input type="checkbox" id="find-whole-word">
						<span>Whole word (Ab|)</span>
					</label>
					<label class="find-option">
						<input type="checkbox" id="find-regex">
						<span>Regex (.*)</span>
					</label>
					<button class="find-regex-help-btn" id="find-regex-help-btn" title="View Regex Documentation">?</button>
				</div>
				<!-- Buttons row -->
				<div class="find-buttons-row">
					<button class="find-btn" id="find-previous-btn" title="Previous (Shift+Enter)">â—€ Previous</button>
					<button class="find-btn" id="find-next-btn" title="Next (Enter)">Next â–¶</button>
					<button class="find-btn" id="find-replace-btn" title="Replace">Replace</button>
					<button class="find-btn" id="find-replace-all-btn" title="Replace All">Replace All</button>
				</div>
			</div>
		</div>
	</div>

</div>

<!-- Shared modules -->
<script src="js/shared/panel-manager.js"></script>
<script src="js/shared/resizable-pane.js"></script>
<script src="js/shared/scroll-sync.js"></script>
<script src="js/shared/find-manager.js"></script>

<!-- Markdown modules -->
<script src="js/markdown/rule-engine.js"></script>
<script src="js/markdown/block-processor.js"></script>
<script src="js/markdown/shortcut-processor.js"></script>
<script src="js/markdown/markdown-parser.js"></script>
<script src="js/markdown/window-manager.js"></script>
<script src="js/markdown/markdown-renderer.js"></script>
<script src="js/markdown/document.js"></script>
<script src="js/markdown/document-manager.js"></script>
<script src="js/markdown/tab-controller.js"></script>
<script src="js/markdown/typora-adapter.js"></script>
<script src="js/markdown/theme-loader.js"></script>

<!-- Embedded regex documentation (to avoid CORS issues) -->
<script src="js/shared/regex-docs-content.js"></script>

<!-- Settings Manager -->
<script src="js/shared/settings-manager.js"></script>

<!-- Line Mapper (Scroll Sync & WYSIWYG Infrastructure) -->
<script src="js/shared/line-mapper.js"></script>

<!-- WYSIWYG Engine -->
<script src="js/wysiwyg/wysiwyg-engine.js"></script>

<!-- Main application script -->
<script src="js/markdown-editor-main.js"></script>
</body>
</html>
